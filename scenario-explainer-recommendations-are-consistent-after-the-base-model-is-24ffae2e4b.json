{"id":"critique-octaipipe-advice;explainer-recommendations-are-consistent-after-the-base-model-is-updated","name":"Explainer recommendations are consistent after the base model is updated","title":"Explainer recommendations are consistent after the base model is updated","manual":false,"testSteps":[{"number":1,"description":"Explainer recommendations are consistent after the base model is updated #1 - Zone: 1, Set Point: SAT, Recommended Value: 0.85","startTime":"2025-07-12T09:28:04.390Z","children":[{"number":2,"description":"Given Des updates the base model\n| Old | New |\n| 1.3 | 1.4 |","startTime":"2025-07-12T09:28:04.392Z","children":[{"number":3,"description":"Des updates the base model","startTime":"2025-07-12T09:28:04.399Z","children":[{"number":4,"description":"Des logs: &apos;updating base model&apos;","startTime":"2025-07-12T09:28:04.400Z","children":[],"reportData":[{"id":"report-data-9a60d732a25b51a36eff4bc2aca354d1bb014f6d","isEvidence":false,"path":"","title":"'updating base model'","contents":"'updating base model'"}],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-logs-updating-base-model-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-logs-updating-base-model-5c9469c475.png","timeStamp":1752312484539}],"duration":0,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":152,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":170,"result":"SUCCESS"},{"number":5,"description":"When Des generates recommendations for &quot;Site 1&quot;","startTime":"2025-07-12T09:28:04.562Z","children":[{"number":6,"description":"Des requests advice for site","startTime":"2025-07-12T09:28:04.570Z","children":[{"number":7,"description":"Des sends a POST request to &apos;/advice&apos;","startTime":"2025-07-12T09:28:04.570Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-sends-a-post-request-to-advic-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-sends-a-post-request-to-advic-5c9469c475.png","timeStamp":1752312484714}],"duration":54,"result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:3000/advice","content":"{\"name\":\"Site 1\"}","contentType":"application/json","requestHeaders":"Accept: application/json, text/plain, */*\nContent-Type: application/json\nUser-Agent: axios/1.10.0\nContent-Length: 17\nAccept-Encoding: gzip, compress, deflate, br","requestCookies":"","statusCode":200,"responseHeaders":"x-powered-by: Express\ncontent-type: application/json; charset=utf-8\ncontent-length: 111\netag: W/\"6f-ZsJEJ/xtJnH7tnL9reQ2yfIEWAQ\"\ndate: Sat, 12 Jul 2025 09:28:04 GMT\nconnection: close","responseCookies":"","responseBody":"{\n    \"advice\": \"The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.\"\n}"}},{"number":8,"description":"Des ensures that the status of the last response does equal 200","startTime":"2025-07-12T09:28:04.725Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-status-of-the-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-status-of-the-5c9469c475.png","timeStamp":1752312484789}],"duration":2,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":228,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":246,"result":"SUCCESS"},{"number":9,"description":"Then Des sees that the advice for Zone &quot;1&quot; is for &quot;SAT&quot; to be &quot;0.85&quot;","startTime":"2025-07-12T09:28:04.808Z","children":[{"number":10,"description":"Des checks that advice matches expectations","startTime":"2025-07-12T09:28:04.816Z","children":[{"number":11,"description":"Des ensures that &quot;The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.&quot; does include &quot;Zone 1&quot;","startTime":"2025-07-12T09:28:04.816Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","timeStamp":1752312484872}],"duration":1,"result":"SUCCESS"},{"number":12,"description":"Des ensures that &quot;The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.&quot; does include &quot;SAT&quot;","startTime":"2025-07-12T09:28:04.878Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","timeStamp":1752312484940}],"duration":1,"result":"SUCCESS"},{"number":13,"description":"Des ensures that &quot;The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.&quot; does include &quot;0.85&quot;","startTime":"2025-07-12T09:28:04.950Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","timeStamp":1752312485006}],"duration":1,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":196,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":214,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":656,"result":"SUCCESS"},{"number":14,"description":"Explainer recommendations are consistent after the base model is updated #2 - Zone: 2, Set Point: PAT, Recommended Value: 1.75","startTime":"2025-07-12T09:28:05.049Z","children":[{"number":15,"description":"Given Des updates the base model\n| Old | New |\n| 1.3 | 1.4 |","startTime":"2025-07-12T09:28:05.050Z","children":[{"number":16,"description":"Des updates the base model","startTime":"2025-07-12T09:28:05.052Z","children":[{"number":17,"description":"Des logs: &apos;updating base model&apos;","startTime":"2025-07-12T09:28:05.052Z","children":[],"reportData":[{"id":"report-data-ae40437f7a13e8658655ffd00d8283c2532007e8","isEvidence":false,"path":"","title":"'updating base model'","contents":"'updating base model'"}],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-logs-updating-base-model-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-logs-updating-base-model-5c9469c475.png","timeStamp":1752312485158}],"duration":0,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":112,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":125,"result":"SUCCESS"},{"number":18,"description":"When Des generates recommendations for &quot;Site 1&quot;","startTime":"2025-07-12T09:28:05.175Z","children":[{"number":19,"description":"Des requests advice for site","startTime":"2025-07-12T09:28:05.179Z","children":[{"number":20,"description":"Des sends a POST request to &apos;/advice&apos;","startTime":"2025-07-12T09:28:05.179Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-sends-a-post-request-to-advic-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-sends-a-post-request-to-advic-5c9469c475.png","timeStamp":1752312485239}],"duration":4,"result":"SUCCESS","restQuery":{"method":"POST","path":"http://localhost:3000/advice","content":"{\"name\":\"Site 1\"}","contentType":"application/json","requestHeaders":"Accept: application/json, text/plain, */*\nContent-Type: application/json\nUser-Agent: axios/1.10.0\nContent-Length: 17\nAccept-Encoding: gzip, compress, deflate, br","requestCookies":"","statusCode":200,"responseHeaders":"x-powered-by: Express\ncontent-type: application/json; charset=utf-8\ncontent-length: 111\netag: W/\"6f-ZsJEJ/xtJnH7tnL9reQ2yfIEWAQ\"\ndate: Sat, 12 Jul 2025 09:28:05 GMT\nconnection: close","responseCookies":"","responseBody":"{\n    \"advice\": \"The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.\"\n}"}},{"number":21,"description":"Des ensures that the status of the last response does equal 200","startTime":"2025-07-12T09:28:05.244Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-status-of-the-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-status-of-the-5c9469c475.png","timeStamp":1752312485305}],"duration":0,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":137,"result":"SUCCESS"}],"reportData":[],"screenshots":[],"duration":151,"result":"SUCCESS"},{"number":22,"description":"Then Des sees that the advice for Zone &quot;2&quot; is for &quot;PAT&quot; to be &quot;1.75&quot;","startTime":"2025-07-12T09:28:05.326Z","children":[{"number":23,"description":"Des checks that advice matches expectations","startTime":"2025-07-12T09:28:05.334Z","children":[{"number":24,"description":"Des ensures that &quot;The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.&quot; does include &quot;Zone 2&quot;","startTime":"2025-07-12T09:28:05.334Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","timeStamp":1752312485389}],"duration":1,"result":"SUCCESS"},{"number":25,"description":"Des ensures that &quot;The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.&quot; does include &quot;PAT&quot;","startTime":"2025-07-12T09:28:05.395Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-sat-set-point-5c9469c475.png","timeStamp":1752312485456}],"duration":1,"result":"SUCCESS"},{"number":26,"description":"Des ensures that &lt;&lt;the body of the last response&gt;&gt;.advice does include &quot;1.75&quot;","startTime":"2025-07-12T09:28:05.458Z","children":[],"reportData":[],"screenshots":[{"screenshot":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-body-of-the-5c9469c475.png","screenshotName":"photo-linux-chromium-138.0.7204.23-des-ensures-that-the-body-of-the-5c9469c475.png","timeStamp":1752312485522}],"duration":1,"result":"FAILURE","exception":{"errorType":"AssertionError","message":"Expected <<the body of the last response>>.advice to include \"1.75\"\n\nExpectation: includes('1.75')\n\nExpected string: 1.75\nReceived string: The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.\n\n    at /home/runner/work/OPtest/OPtest/features/step-definitions/data-science.steps.ts:16:36","stackTrace":[{"declaringClass":"","methodName":"","fileName":"/home/runner/work/OPtest/OPtest/features/step-definitions/data-science.steps.ts","lineNumber":16},{"declaringClass":"","methodName":"ErrorFactory.create()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/errors/ErrorFactory.ts","lineNumber":35},{"declaringClass":"","methodName":"Stage.createError()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/stage/Stage.ts","lineNumber":328},{"declaringClass":"","methodName":"RaiseErrors.create()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/errors/RaiseErrors.ts","lineNumber":59},{"declaringClass":"","methodName":"Ensure.performAs()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/assertions/src/Ensure.ts","lineNumber":137},{"declaringClass":"","methodName":"async PerformActivities.perform()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/screenplay/abilities/PerformActivities.ts","lineNumber":60},{"declaringClass":"","methodName":"async PerformActivities.perform()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/screenplay/abilities/PerformActivities.ts","lineNumber":60},{"declaringClass":"","methodName":"async wrapPromiseWithTimeout()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@cucumber/cucumber/src/time.ts","lineNumber":55},{"declaringClass":"","methodName":"async Object.run()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@cucumber/cucumber/src/user_code_runner.ts","lineNumber":86},{"declaringClass":"","methodName":"async Object.run()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@cucumber/cucumber/src/runtime/step_runner.ts","lineNumber":53},{"declaringClass":"","methodName":"async TestCaseRunner.invokeStep()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@cucumber/cucumber/src/runtime/test_case_runner.ts","lineNumber":140}]}}],"reportData":[],"screenshots":[],"duration":196,"result":"FAILURE"}],"reportData":[],"screenshots":[],"duration":216,"result":"FAILURE"}],"reportData":[],"screenshots":[],"duration":514,"result":"FAILURE"}],"userStory":{"id":"critique-octaipipe-advice","storyName":"Critique Octaipipe advice","displayName":"Critique Octaipipe advice","path":"dataScience/critique-advice","type":"feature","narrative":"The advisor is an LLM agent, therefore:\n- The output may not be deterministic\n- The output may differ between runs\n- The output may differ as the base model is updated\n- The advisor should indicate its level of confidence","pathElements":[{"name":"dataScience","description":"DataScience"},{"name":"critique-advice","description":"Critique-advice"}]},"dataTable":{"scenarioOutline":"Given Des updates the base model\n| Old | New |\n| 1.3 | 1.4 |\nWhen Des generates recommendations for \"Site 1\"\nThen Des sees that the advice for Zone \"<Zone>\" is for \"<Set Point>\" to be \"<Recommended Value>\"","dataSetDescriptors":[{"name":"","description":"","startRow":0,"rowCount":2}],"headers":["Zone","Set Point","Recommended Value"],"rows":[{"values":["1","SAT","0.85"],"result":"SUCCESS"},{"values":["2","PAT","1.75"],"result":"FAILURE"}],"predefinedRows":true},"startTime":"2025-07-12T09:28:04.390Z","testSource":"JS","tags":[{"name":"Data science","type":"capability","displayName":"Data science"},{"name":"Data science/Critique Octaipipe advice","type":"feature","displayName":"Critique Octaipipe advice"}],"featureTag":{"name":"Data science/Critique Octaipipe advice","type":"feature","displayName":"Critique Octaipipe advice"},"actors":[{"name":"Des","can":["PerformActivities","AnswerQuestions","RaiseErrors","ScheduleWork { scheduler: { clock: { timeAdjustment: { milliseconds: 0 } }, interactionTimeout: { milliseconds: 5000 } } }","BrowseTheWeb (BrowseTheWebWithPlaywright)","CallAnApi { baseURL: \"http://localhost:3000/\", headers: { common: { Accept: \"application/json, text/plain, */*\" } }, timeout: 10000 }","TakeNotes { notepad: {} }"]}],"duration":1173,"result":"FAILURE","testFailureCause":{"errorType":"AssertionError","message":"Expected <<the body of the last response>>.advice to include \"1.75\"\n\nExpectation: includes('1.75')\n\nExpected string: 1.75\nReceived string: The SAT set point in Zone 1 should be set to 0.85. In Zone 2, the PAT set point can be below 1.74.","stackTrace":[{"declaringClass":"","methodName":"","fileName":"/home/runner/work/OPtest/OPtest/features/step-definitions/data-science.steps.ts","lineNumber":16},{"declaringClass":"","methodName":"","fileName":"/home/runner/work/OPtest/OPtest/features/step-definitions/data-science.steps.ts","lineNumber":16},{"declaringClass":"","methodName":"ErrorFactory.create()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/errors/ErrorFactory.ts","lineNumber":35},{"declaringClass":"","methodName":"Stage.createError()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/stage/Stage.ts","lineNumber":328},{"declaringClass":"","methodName":"RaiseErrors.create()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/errors/RaiseErrors.ts","lineNumber":59},{"declaringClass":"","methodName":"Ensure.performAs()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/assertions/src/Ensure.ts","lineNumber":137},{"declaringClass":"","methodName":"async PerformActivities.perform()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/screenplay/abilities/PerformActivities.ts","lineNumber":60},{"declaringClass":"","methodName":"async PerformActivities.perform()","fileName":"/home/runner/work/OPtest/OPtest/node_modules/@serenity-js/core/src/screenplay/abilities/PerformActivities.ts","lineNumber":60}]}}